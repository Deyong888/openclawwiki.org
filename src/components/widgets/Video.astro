---
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import Headline from '~/components/ui/Headline.astro';
import type { Widget } from '~/types';

export interface Props extends Widget {
  items?: Array<{
    src: string;
    title?: string;
  }>;
}

const {
  title = '',
  subtitle = '',
  tagline = '',
  id,
  isDark = false,
  classes = {},
  bg = await Astro.slots.render('bg'),
  items = [],
} = Astro.props;
---

<WidgetWrapper id={id} isDark={isDark} containerClass={`max-w-6xl mx-auto ${classes?.container ?? ''}`} bg={bg}>
  <Headline title={title} subtitle={subtitle} tagline={tagline} />

  <div class="grid gap-6 row-gap-5 md:grid-cols-2 lg:grid-cols-3 -mb-6">
    {
      items.map(({ src, title }) => (
        <div class="mb-6 transition hover:scale-105 duration-300 ease-in-out">
          <div class="relative w-full aspect-video rounded-xl shadow-lg overflow-hidden border border-gray-200 dark:border-slate-800">
             {src.includes('youtube.com') || src.includes('youtu.be') ? (
                <iframe
                  width="100%"
                  height="100%"
                  src={`https://www.youtube.com/embed/${src.split('v=')[1]?.split('&')[0]}`}
                  title={title || 'YouTube video player'}
                  frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  allowfullscreen
                ></iframe>
             ) : (
               <video src={src} controls class="w-full h-full object-cover"></video>
             )}
          </div>
          {title && <h3 class="mt-3 text-lg font-semibold text-center text-gray-800 dark:text-gray-200">{title}</h3>}
        </div>
      ))
    }
  </div>
</WidgetWrapper>
